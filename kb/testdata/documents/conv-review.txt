Emily: I'm reviewing your PR for the vector search feature. A few things - why are you opening a new DuckDB connection for every query instead of using a connection pool?

Frank: DuckDB is an embedded database, so it's different from Postgres. Each connection opens its own instance of the database. A pool wouldn't help because DuckDB handles concurrency internally with a single writer and multiple readers.

Emily: Oh interesting. So the connection is basically just a handle to the file? What about the HNSW index - does it stay in memory between queries?

Frank: Each connection loads the index fresh. But since we're reading from the local filesystem cache, the OS page cache keeps the data warm. First query after a cold start takes about 20ms, subsequent queries are under 5ms.

Emily: That's fast enough for our use case. One more thing - I see you're formatting the vector as a SQL string literal. Is that safe from injection?

Frank: Good catch. The vector values are float32s generated by our own embedder, never from user input. But I should still use parameterized queries. Let me update that.

Emily: Agreed. Approved pending that change. Nice work on the HNSW integration.